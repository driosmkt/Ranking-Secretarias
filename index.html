<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard com Google Sheets - Corrida Digital</title>
    <style>
        /* CSS Principal (sem alterações) */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
        :root { --cor-fundo: #0f1018; --cor-card: #1c1d2b; --cor-card-secundario: #212232; --cor-texto-principal: #ffffff; --cor-texto-secundario: #a7a7a7; --cor-amarelo: #f9c74f; --cor-azul: #4a90e2; --cor-vermelho: #e74c3c; --cor-verde: #2ecc71; }
        body { background-color: var(--cor-fundo); color: var(--cor-texto-principal); font-family: 'Poppins', sans-serif; margin: 0; padding: 20px 20px 150px 20px; /* Adicionado padding-bottom para não sobrepor o rodapé */ display: flex; flex-direction: column; align-items: center; }
        h1, h2, h3 { text-align: center; }
        h1 { color: var(--cor-amarelo); font-size: 2.5em; letter-spacing: 2px; margin-bottom: 0; }
        h2 { font-size: 1.8em; margin-top: 5px; }
        .update-container { background-color: var(--cor-card); border-radius: 10px; padding: 25px; margin-top: 30px; width: 100%; max-width: 800px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); }
        .update-container h3 { margin-top: 0; color: var(--cor-amarelo); }
        #update-form { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; align-items: flex-end; }
        .form-group { display: flex; flex-direction: column; }
        .form-group label { margin-bottom: 8px; font-size: 0.9em; color: var(--cor-texto-secundario); }
        .form-group select, .form-group input { background-color: var(--cor-card-secundario); color: var(--cor-texto-principal); border: 1px solid #444; border-radius: 5px; padding: 10px; font-family: 'Poppins', sans-serif; font-size: 1em; }
        #update-button { background-color: var(--cor-azul); color: var(--cor-texto-principal); border: none; border-radius: 5px; padding: 12px; font-weight: 600; cursor: pointer; transition: background-color 0.3s ease; height: 45px; }
        #update-button:hover { background-color: #357abd; }
        #reset-button { background-color: transparent; border: 1px solid var(--cor-vermelho); color: var(--cor-vermelho); transition: background-color 0.3s, color 0.3s; }
        #reset-button:hover { background-color: var(--cor-vermelho); color: var(--cor-texto-principal); }
        .podium-container { display: flex; justify-content: center; align-items: flex-end; gap: 20px; flex-wrap: wrap; width: 100%; max-width: 1200px; margin-top: 40px; }
        .podium-card { background-color: var(--cor-card); border: 2px solid transparent; border-radius: 10px; padding: 25px; text-align: center; width: 280px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); transition: transform 0.3s ease, border-color 0.3s ease; }
        .podium-card:hover { transform: translateY(-10px); }
        .podium-card h3 { margin: 0; font-size: 1.2em; color: var(--cor-texto-principal); height: 40px; }
        .podium-card .posicao { font-size: 3em; font-weight: 700; }
        .podium-card-1 { order: 2; height: 280px; border-color: #ffd700; }
        .podium-card-2 { order: 1; height: 250px; border-color: #c0c0c0; }
        .podium-card-3 { order: 3; height: 250px; border-color: #cd7f32; }
        .podium-card-1 .posicao { color: #ffd700; }
        .podium-card-2 .posicao { color: #c0c0c0; }
        .podium-card-3 .posicao { color: #cd7f32; }
        .podium-data { margin-top: 20px; text-align: left; font-size: 0.9em; }
        .podium-data p { display: flex; justify-content: space-between; margin: 10px 0; }
        .podium-data span { font-weight: 600; }
        .ranking-container { width: 100%; max-width: 1000px; margin-top: 50px; }
        .ranking-table { width: 100%; border-collapse: collapse; margin-top: 20px; background-color: var(--cor-card); border-radius: 10px; overflow: hidden; }
        .ranking-table th, .ranking-table td { padding: 15px; text-align: left; }
        .ranking-table thead { background-color: #2a2c3d; color: var(--cor-amarelo); font-weight: 600; }
        .ranking-table tbody tr { border-bottom: 1px solid #2a2c3d; }
        .ranking-table tbody tr:last-child { border-bottom: none; }
        .ranking-table tbody tr:nth-child(even) { background-color: var(--cor-card-secundario); }
        .ranking-table .pos-cell { font-weight: 700; color: var(--cor-amarelo); text-align: center; }

        /* --- NOVO CSS PARA O RODAPÉ --- */
        .footer {
            width: 100%;
            padding: 40px 20px;
            text-align: center;
            margin-top: 60px;
            border-top: 1px solid #2a2c3d;
        }
        .footer-title {
            font-size: 1.2em;
            font-weight: 600;
            color: var(--cor-texto-principal);
            margin: 0;
        }
        .status-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
            gap: 10px;
        }
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: var(--cor-texto-secundario); /* Cor padrão 'carregando' */
            animation: pulse 2s infinite;
        }
        .status-text {
            font-weight: 600;
            letter-spacing: 1px;
            color: var(--cor-texto-secundario); /* Cor padrão */
        }
        .footer-copyright {
            font-size: 0.9em;
            color: var(--cor-texto-secundario);
            margin: 0;
        }

        /* Animação de pulso para o status */
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(249, 199, 79, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(249, 199, 79, 0); }
            100% { box-shadow: 0 0 0 0 rgba(249, 199, 79, 0); }
        }
    </style>
</head>
<body>
    <header>
        <h1>SIMÃO NA REDE DIGITAL</h1>
        <h2>CORRIDA DIGITAL</h2>
    </header>

    <section class="update-container">
        <!-- O formulário continua igual -->
    </section>

    <main>
        <!-- O conteúdo do pódio e ranking continua igual -->
    </main>

    <!-- NOVO RODAPÉ -->
    <footer class="footer">
        <p class="footer-title">Núcleo Digital da Secretaria de Comunicação</p>
        <div class="status-indicator">
            <span id="status-dot" class="status-dot"></span>
            <span id="status-text" class="status-text">CARREGANDO...</span>
        </div>
        <p class="footer-copyright">© 2025 Prefeitura de Petrolina – Secretaria de Comunicação</p>
    </footer>

    <script>
        // COLE AQUI A URL DO SEU APP SCRIPT PUBLICADO
        const SCRIPT_URL = 'COLE_SUA_URL_DO_APP_DA_WEB_AQUI';

        let dadosSecretarias = [];
        let isLoading = true;

        // Elementos do DOM, incluindo os novos do rodapé
        const form = document.getElementById('update-form');
        const select = document.getElementById('secretaria-select');
        const cadastrosInput = document.getElementById('cadastros-input');
        const cliquesInput = document.getElementById('cliques-input');
        const membrosInput = document.getElementById('membros-input');
        const resetButton = document.getElementById('reset-button');
        const podiumContainer = document.getElementById('podium-container');
        const rankingBody = document.getElementById('ranking-body');
        const statusDot = document.getElementById('status-dot');
        const statusText = document.getElementById('status-text');

        // Funções de renderização (continuam iguais)
        function sortAndRank(){/*...*/}
        function renderPodium(){/*...*/}
        function renderRankingTable(){/*...*/}
        function updateDisplay(){/*...*/}
        function populateSelect(){/*...*/}
        function fillFormWithSelectedData(){/*...*/}
        
        async function loadData() {
            try {
                const response = await fetch(SCRIPT_URL);
                if (!response.ok) throw new Error("Erro de rede ao buscar dados.");
                
                dadosSecretarias = await response.json();
                isLoading = false;

                // ATUALIZA O STATUS PARA CONECTADO
                statusDot.style.backgroundColor = 'var(--cor-amarelo)';
                statusText.textContent = 'CONECTADO';
                statusText.style.color = 'var(--cor-amarelo)';

                updateDisplay();
                populateSelect();
                fillFormWithSelectedData();

            } catch (error) {
                console.error("Falha ao buscar dados da planilha:", error);
                
                // ATUALIZA O STATUS PARA FALHA
                statusDot.style.backgroundColor = 'var(--cor-vermelho)';
                statusDot.style.animation = 'none'; // Para a animação no erro
                statusText.textContent = 'FALHA NA CONEXÃO';
                statusText.style.color = 'var(--cor-vermelho)';
                
                alert("Não foi possível carregar os dados da planilha. Verifique a URL do Script ou a sua conexão.");
            }
        }
        
        // As funções handleFormSubmit e handleReset continuam as mesmas da versão anterior
        async function handleFormSubmit() {/*...*/}
        async function handleReset() {/*...*/}

        // --- INICIALIZAÇÃO ---
        window.onload = () => {
            // ... (event listeners continuam os mesmos) ...
            loadData();
        };

        // Cole aqui as funções que não foram alteradas para economizar espaço
        function sortAndRank(){dadosSecretarias.sort((a,b)=>{if(b.cadastros!==a.cadastros)return b.cadastros-a.cadastros;if(b.cliques!==a.cliques)return b.cliques-a.cliques;return b.membros-a.membros;});}
        function renderPodium(){podiumContainer.innerHTML = ''; const top3 = dadosSecretarias.slice(0, 3); top3.forEach((secretaria, index) => { const card = document.createElement('div'); card.className = `podium-card podium-card-${index + 1}`; card.innerHTML = `<span class="posicao">${index + 1}º</span><h3>${secretaria.nome}</h3><div class="podium-data"><p>Cadastros: <span>${secretaria.cadastros}</span></p><p>Cliques no Link: <span>${secretaria.cliques}</span></p><p>Membros no Grupo: <span>${secretaria.membros}</span></p></div>`; podiumContainer.appendChild(card); });}
        function renderRankingTable(){rankingBody.innerHTML = ''; const restoDoRanking = dadosSecretarias.slice(3); restoDoRanking.forEach((secretaria, index) => { const posicao = index + 4; const linha = document.createElement('tr'); linha.innerHTML = `<td class="pos-cell">${posicao}º</td><td>${secretaria.nome}</td><td>${secretaria.cadastros}</td><td>${secretaria.cliques}</td><td>${secretaria.membros}</td>`; rankingBody.appendChild(linha); });}
        function updateDisplay(){sortAndRank();renderPodium();renderRankingTable();}
        function populateSelect(){const sortedByName=[...dadosSecretarias].sort((a,b)=>a.nome.localeCompare(b.nome));select.innerHTML='';sortedByName.forEach(secretaria=>{const option=document.createElement('option');option.value=secretaria.nome;option.textContent=secretaria.nome;select.appendChild(option);});}
        function fillFormWithSelectedData(){if(isLoading)return;const selectedName=select.value;const secretariaData=dadosSecretarias.find(s=>s.nome===selectedName);if(secretariaData){cadastrosInput.value=secretariaData.cadastros;cliquesInput.value=secretariaData.cliques;membrosInput.value=secretariaData.membros;}}
        async function handleFormSubmit() {const selectedName = select.value;const secretariaData = {nome: selectedName,cadastros: parseInt(cadastrosInput.value) || 0,cliques: parseInt(cliquesInput.value) || 0,membros: parseInt(membrosInput.value) || 0};try {const response = await fetch(SCRIPT_URL, {method: 'POST',mode: 'no-cors',headers: { 'Content-Type': 'application/json' },body: JSON.stringify(secretariaData)});alert(`Atualização para "${selectedName}" enviada! Os dados serão recarregados.`);loadData();} catch (error) {console.error("Falha ao enviar atualização:", error);alert("Ocorreu um erro ao enviar a atualização.");}}
        async function handleReset() {if (confirm('Tem certeza de que deseja restaurar os dados originais na planilha?')) {try {await fetch(SCRIPT_URL, {method: 'POST',mode: 'no-cors',headers: { 'Content-Type': 'application/json' },body: JSON.stringify({ action: 'reset' })});alert('Os dados originais foram restaurados. A página será atualizada.');loadData();} catch (error) {console.error("Falha ao resetar:", error);}}}
        window.onload = () => {form.addEventListener('submit', handleFormSubmit);resetButton.addEventListener('click', handleReset);select.addEventListener('change', fillFormWithSelectedData);loadData();};
    </script>
</body>
</html>
